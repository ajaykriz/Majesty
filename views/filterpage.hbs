<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<link rel="stylesheet" href="https://fontawesome.com/v4.7.0/assets/font-awesome/css/font-awesome.css">


<div class="container pt-5">
    <div class="pt-5">

    
    <div class="row pt-5">

        <aside class=" col-md-3">
            <form id="filter" method="post">
                <div class="card">
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_1" aria-expanded="true" class="">
                                <i class="icon-control fa fa-chevron-down"></i>
                                <h6 class="title">Category Types</h6>
                            </a>
                        </header>


                        <div class="filter-content collapse show" id="collapse_2" style="">
                            <div class="card-body">


                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" value="MEN"
                                        name="category">
                                    <div class="custom-control-label">MEN
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" value="WOMEN"
                                        name="category">
                                    <div class="custom-control-label">WOMEN
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" name="category" value="" hidden
                                        checked>

                                </label>

                            </div>
                        </div>
                    </article>


                    <!-- filter-group  .// -->
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_2" aria-expanded="true" class="">
                                <i class="icon-control fa fa-chevron-down"></i>
                                <h6 class="title">Brands </h6>
                            </a>
                        </header>
                        <div class="filter-content collapse show" id="collapse_2" style="">
                            <div class="card-body">

                                {{#each brand}}

                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" value="{{this.brand}}"
                                        name="brand">
                                    <div class="custom-control-label">{{this.brand}}
                                    </div>
                                </label>
                                {{/each}}
                                <label class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" name="brand" value="" hidden
                                        checked>

                                </label>

                            </div>
                        </div>
                    </article>

                    <!-- filter-group .// -->
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_3" aria-expanded="true" class="">
                                <i class="icon-control fa fa-chevron-down"></i>
                                <h6 class="title">Price range </h6>
                            </a>
                        </header>

                        <div class="filter-content collapse show" id="collapse_2" style="">
                            <div class="card-body">



                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="500" name="price">
                                    <div class="custom-control-label">Under 500
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="1000" name="price">
                                    <div class="custom-control-label">Under 1000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="5000" name="price">
                                    <div class="custom-control-label">Under 5000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="10000" name="price">
                                    <div class="custom-control-label">Under 10000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" value="20000" name="price">
                                    <div class="custom-control-label">Under 20000
                                    </div>
                                </label>
                                <label class="custom-control custom-checkbox">
                                    <input type="radio" class="custom-control-input" name="price" value="60000" hidden
                                        checked>

                                </label>


                            </div>
                        </div>

                    </article>

                </div>
            </form>
        </aside>
        <main class="col-md-9">

            <header class="border-bottom mb-4 pb-3">
                <div class="form-inline float-end">
                    <form class="d-flex justify-content-between" action="/getSearchProducts" method="post"> 
                    <input autocomplete="off" id="search-box" name="key" type="text" class="form-control" placeholder="Search"
                    style="min-width: 125px;" />
                   <button   style="border: none ;outline: none; background-color:white;" type="submit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                  </svg></button>
                   </form> 
                </div>
            </header>

     <div class="container pt-5" >
				
				<div class="row pb-2"  id="products">
                    {{#each filterResult}}
					<!-- single product -->
					<div class="col-6 col-lg-4 col-md-6 pb-5 border">
						<div class="single-product ">
							<a href="/viewProduct/{{this._id}}"><img class="img-fluid border border-warning rounded" src="/uploads/{{this.image.[0].image1}}" alt=""></a>
							<div class="product-details ">
								<h6><a>{{this.title}}</a></h6>
								<div class="price">
									<h6>Rs.{{this.price}}</h6>
                                    
								</div>
                                

                                {{#if ../user}}
							<button
                  class="btn btn-danger text-uppercase mr-2 px-4"
                  onclick="addtoCart('{{this._id}}')"
                >Add to cart</button>
                <a onclick="addToWishlist('{{this._id}}')" class="btn"><i
                    class="fa fa-heart "
                  ></i></a>
							
                          {{else}}
							 <button
                  class="btn btn-danger text-uppercase mr-2 px-4"
                 
                >Add to cart</button>
                <a  class="btn"><i
                    class="fa fa-heart "
                  ></i></a>
							{{/if}}

                                
                                

							</div>
						</div>
					</div>
                    {{/each}}
					
					
				</div>
			</div>
            

        




    </div>

    <nav class="mt-4" aria-label="Page navigation sample">
        <ul class="pagination">
            <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
            <li class="page-item active"><a class="page-link" href="#">1</a></li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item"><a class="page-link" href="#">Next</a></li>
        </ul>
    </nav>
    </main>
</div>
</div>
</div>
<script>
function addtoCart(proId){
    $.ajax({
      url:'/add-to-cart/'+proId,
      method:'get',
      success:(response)=>{
        if(response.status){
          let count=$('#cartcount').html()
          count=parseInt(count)+1
          $('#cartcount').html(count)

        }
        
      }
    })
  };
  function addToWishlist(proId){
    $.ajax({
      url:'/add-to-wishlist/'+proId,
      method:'get',
      success:(response)=>{
        if(response.status){
          let count=$('#wishlistcount').html()
          count=parseInt(count)+1
          $('#wishlistcount').html(count)

        }
        
      }
    })
  };
</script>   
   <script>
                $('input[name=brand]').change(function () {

                    $.ajax({
                        url: '/search-filter',
                        method: "post",
                        data: $('#filter').serialize(),
                        success: (isResult) => {
                            console.log(isResult)
                            if (isResult) {
                                // window.location.reload()
                                // $('#products').load('/products/filter');
                                $('#products').load(location.href + " #products");
                            }
                        }
                    })

                });

                $('input[name=price]').change(function () {

                    $.ajax({
                        url: '/search-filter',
                        method: "post",
                        data: $('#filter').serialize(),
                        success: (isResult) => {
                            console.log(isResult)
                            if (isResult) {
                                // window.location.reload()
                                // $('#products').load('/products/filter');
                                $('#products').load(location.href + " #products");
                            }
                        }
                    })

                });

                $('input[name=category]').change(function () {

                    $.ajax({
                        url: '/search-filter',
                        method: "post",
                        data: $('#filter').serialize(),
                        success: (isResult) => {
                            if (isResult) {
                                // window.location.reload()
                                // $('#products').load('/products/filter');
                                $('#products').load(location.href + " #products");
                            }
                        }
                    })

                });
            </script>
            <style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap');

body {
    font-family: "Poppins", sans-serif;
    color: #444444;
}

a,
a:hover {
    text-decoration: none;
    color: inherit;
}

.section-products {
    padding: 80px 0 54px;
}

.section-products .header {
    margin-bottom: 50px;
}

.section-products .header h3 {
    font-size: 1rem;
    color: #fe302f;
    font-weight: 500;
}

.section-products .header h2 {
    font-size: 2.2rem;
    font-weight: 400;
    color: #444444; 
}

.section-products .single-product {
    margin-bottom: 26px;
}

.section-products .single-product .part-1 {
    position: relative;
    height: 72px;
    max-height: 290px;
    margin-bottom: 20px;
    overflow: hidden;
}

.section-products .single-product .part-1::before {
		position: absolute;
		content: "";
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: -1;
		transition: all 0.3s;
}

.section-products .single-product:hover .part-1::before {
		transform: scale(1.2,1.2) rotate(5deg);
}

.section-products #product-1 .part-1::before {
    {{!-- background: url("https://i.ibb.co/L8Nrb7p/1.jpg") no-repeat center; --}}
    background-size: cover;
		transition: all 0.3s;
}



.section-products .single-product .part-1 .discount,
.section-products .single-product .part-1 .new {
    position: absolute;
    top: 15px;
    left: 20px;
    color: #ffffff;
    background-color: #fe302f;
    padding: 2px 8px;
    text-transform: uppercase;
    font-size: 0.85rem;
}

.section-products .single-product .part-1 .new {
    left: 0;
    background-color: #444444;
}

.section-products .single-product .part-1 ul {
    position: absolute;
    bottom: -41px;
    left: 20px;
    margin: 0;
    padding: 0;
    list-style: none;
    opacity: 0;
    transition: bottom 0.5s, opacity 0.5s;
}

.section-products .single-product:hover .part-1 ul {
    bottom: 30px;
    opacity: 1;
}

.section-products .single-product .part-1 ul li {
    display: inline-block;
    margin-right: 4px;
}

.section-products .single-product .part-1 ul li a {
    display: inline-block;
    width: 40px;
    height: 40px;
    line-height: 40px;
    background-color: #ffffff;
    color: #444444;
    text-align: center;
    box-shadow: 0 2px 20px rgb(50 50 50 / 10%);
    transition: color 0.2s;
}

.section-products .single-product .part-1 ul li a:hover {
    color: #fe302f;
}

.section-products .single-product .part-2 .product-title {
    font-size: 1rem;
}

.section-products .single-product .part-2 h4 {
    display: inline-block;
    font-size: 1rem;
}

.section-products .single-product .part-2 .product-old-price {
    position: relative;
    padding: 0 7px;
    margin-right: 2px;
    opacity: 0.6;
}

.section-products .single-product .part-2 .product-old-price::after {
    position: absolute;
    content: "";
    top: 50%;
    left: 0;
    width: 100%;
    height: 1px;
    background-color: #444444;
    transform: translateY(-50%);
}</style>